<!DOCTYPE html>
<html dir="ltr" lang="zh">

<head>
<meta charset="utf-8">
<meta name="color-scheme" content="light dark">
<meta name="google" value="notranslate">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<script>
// å…¨å±€å˜é‡
var currentPath = "/";
var directoryData = {}; // å­˜å‚¨æ‰€æœ‰ç›®å½•æ•°æ®
var historyStack = [];  // å†å²è®°å½•æ ˆ

// å…·ä½“çš„æ–‡ä»¶ç½‘ç›˜é“¾æ¥å’Œæå–ç 
var fileLinks = {
  "WindowsLonghorn_Build_4074.iso": {
    "url": "https://cloud.189.cn/1XyZ2ABC",
    "code": "abcd",     
    "source": "ç™¾åº¦ç½‘ç›˜",
    "requireCode": true
  },
  "WindowsLonghorn_Build_4083.iso": {
    "url": "https://cloud.189.cn/2AbC3DEF",
    "code": "efgh",
    "source": "ç™¾åº¦ç½‘ç›˜",
    "requireCode": true
  },
  "WindowsLonghorn_Build_4093.iso": {
    "url": "https://cloud.189.cn/3GhI4JKL",
    "code": "ijkl",
    "source": "ç™¾åº¦ç½‘ç›˜",
    "requireCode": true
  },
  "Windows7_Build_6801.iso": {
    "url": "https://cloud.189.cn/t/5Mno6PQR",
    "code": "",
    "source": "å¤©ç¿¼äº‘ç›˜",
    "requireCode": false
  },
  "Windows7_Build_6956.iso": {
    "url": "https://cloud.189.cn/t/7StU8VWX",
    "code": "",
    "source": "å¤©ç¿¼äº‘ç›˜",
    "requireCode": false
  },
  "Windows8_Consumer_Preview.iso": {
    "url": "https://www.123865.com/s/dwB1vd-SZPWv",
    "code": "RJc5",
    "source": "123äº‘ç›˜",
    "requireCode": true
  },
  "Windows8_Build_7850.iso": {
    "url": "https://www.123865.com/s/dwB1vd-30PWv",
    "code": "vLIN",
    "source": "123äº‘ç›˜",
    "requireCode": true
  },
  "Windows10_Build_9833.iso": {
    "url": "https://www.123865.com/s/dwB1vd-ADPWv",
    "code": "oY5Y",
    "source": "123äº‘ç›˜",
    "requireCode": true
  },
  "Windows10_Build_14316.iso": {
    "url": "https://www.123865.com/s/5Qrs6TUV",
    "code": "",
    "source": "",
    "requireCode": false
  },
  "Windows11_Insider_Preview_Dev.iso": {
    "url": "https://www.123865.com/s/7Wxy8Zab",
    "code": "",
    "source": "123äº‘ç›˜",
    "requireCode": false
  },
  "Windows11_Insider_Preview_Beta.iso": {
    "url": "https://www.123865.com/s/9Cde0Fgh",
    "code": "",
    "source": "123äº‘ç›˜",
    "requireCode": false
  },
  "WindowsVista_Beta_1.iso": {
    "url": "https://pan.baidu.com/s/2Ijk3Lmn",
    "code": "mnop",
    "source": "ç™¾åº¦ç½‘ç›˜",
    "requireCode": true
  },
  "WindowsVista_Beta_2.iso": {
    "url": "https://pan.baidu.com/s/4Opq5Rst",
    "code": "qrst",
    "source": "ç™¾åº¦ç½‘ç›˜",
    "requireCode": true
  },
  "WindowsXP_Beta_1.iso": {
    "url": "https://cloud.189.cn/t/6Uvw7Xyz",
    "code": "",
    "source": "å¤©ç¿¼äº‘ç›˜",
    "requireCode": false
  },
  "WindowsXP_Beta_2.iso": {
    "url": "https://cloud.189.cn/t/8Abc9Def",
    "code": "",
    "source": "å¤©ç¿¼äº‘ç›˜",
    "requireCode": false
  }
};

// ç›®å½•ç»“æ„æ•°æ®ï¼ˆæ¨¡æ‹Ÿæ–‡ä»¶ç³»ç»Ÿï¼‰
var fileSystemData = {
  "/": [
    {"name": "WindowsLonghorn", "type": "dir", "size": 0, "modified": 1770120814, "modified_str": "2026/2/3 20:13:34"},
    {"name": "Windows7Beta", "type": "dir", "size": 0, "modified": 1769139141, "modified_str": "2026/1/23 11:32:21"},
    {"name": "Windows8Beta", "type": "dir", "size": 0, "modified": 1737946670, "modified_str": "2025/1/27 10:57:50"},
    {"name": "Windows10Beta", "type": "dir", "size": 0, "modified": 1761140571, "modified_str": "2025/10/22 21:42:51"},
    {"name": "Windows11Beta", "type": "dir", "size": 0, "modified": 1770692202, "modified_str": "2026/2/10 10:56:42"},
    {"name": "WindowsVistaBeta", "type": "dir", "size": 0, "modified": 1757817068, "modified_str": "2025/9/14 10:31:08"},
    {"name": "WindowsXPBeta", "type": "dir", "size": 0, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39"}
  ],
  "/WindowsLonghorn/": [
    {"name": "WindowsLonghorn_Build_4074.iso", "type": "file", "size": 3650722201, "modified": 1761140571, "modified_str": "2025-08-17 13:39:03", "description": "Windows Longhorn Build 4074"},
    {"name": "WindowsLonghorn_Build_4083.iso", "type": "file", "size": 2641404887, "modified": 1761140571, "modified_str": "2025-08-04 11:13:01", "description": "Windows Longhorn Build 4083"},
    {"name": "WindowsLonghorn_Build_4093.iso", "type": "file", "size": 4273492459, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39", "description": "Windows Longhorn Build 4093"}
  ],
  "/Windows7Beta/": [
    {"name": "Windows7_Build_6801.iso", "type": "file", "size": 3650722201, "modified": 1761140571, "modified_str": "2025-08-17 13:39:03", "description": "Windows 7 Build 6801"},
    {"name": "Windows7_Build_6956.iso", "type": "file", "size": 2641404887, "modified": 1761140571, "modified_str": "2025-08-04 11:13:01", "description": "Windows 7 Build 6956"}
  ],
  "/Windows8Beta/": [
    {"name": "Windows8_Consumer_Preview.iso", "type": "file", "size": 3650722201, "modified": 1761140571, "modified_str": "2025-08-17 13:39:03", "description": "Windows 8 æ¶ˆè´¹è€…é¢„è§ˆç‰ˆ"},
    {"name": "Windows8_Build_7850.iso", "type": "file", "size": 2641404887, "modified": 1761140571, "modified_str": "2025-08-04 11:13:01", "description": "Windows 8 Build 7850"}
  ],
  "/Windows10Beta/": [
    {"name": "Windows10_Build_9833.iso", "type": "file", "size": 3446711255, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39", "description": "Windows 10 Build 9833 æŠ€æœ¯é¢„è§ˆç‰ˆ"},
    {"name": "Windows10_Build_14316.iso", "type": "file", "size": 4273492459, "modified": 1663259269, "modified_str": "2025/11/16 10:17:39", "description": "Windows 10 Build 14316"}
  ],
  "/Windows11Beta/": [
    {"name": "Windows11_Insider_Preview_Dev.iso", "type": "file", "size": 3446711255, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39", "description": "Windows 11 å¼€å‘é¢„è§ˆç‰ˆ"},
    {"name": "Windows11_Insider_Preview_Beta.iso", "type": "file", "size": 4273492459, "modified": 1663259269, "modified_str": "2025/11/16 10:17:39", "description": "Windows 11 Beta é¢„è§ˆç‰ˆ"}
  ],
  "/WindowsVistaBeta/": [
    {"name": "WindowsVista_Beta_1.iso", "type": "file", "size": 3446711255, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39", "description": "Windows Vista Beta 1"},
    {"name": "WindowsVista_Beta_2.iso", "type": "file", "size": 4273492459, "modified": 1663259269, "modified_str": "2025/11/16 10:17:39", "description": "Windows Vista Beta 2"}
  ],
  "/WindowsXPBeta/": [
    {"name": "WindowsXP_Beta_1.iso", "type": "file", "size": 3446711255, "modified": 1763259459, "modified_str": "2025/11/16 10:17:39", "description": "Windows XP Beta 1"},
    {"name": "WindowsXP_Beta_2.iso", "type": "file", "size": 4273492459, "modified": 1663259269, "modified_str": "2025/11/16 10:17:39", "description": "Windows XP Beta 2"}
  ]
};

// åˆå§‹åŒ–ç›®å½•æ•°æ®
function initDirectoryData() {
  directoryData = fileSystemData;
}

// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
function formatFileSize(bytes) {
  if (bytes === 0) return '0 B';
  const k = 1024;
  const sizes = ['B', 'KB', 'MB', 'GB', 'TB'];
  const i = Math.floor(Math.log(bytes) / Math.log(k));
  return parseFloat((bytes / Math.pow(k, i)).toFixed(1)) + ' ' + sizes[i];
}

// ç”Ÿæˆç½‘ç›˜é“¾æ¥ - ç›´æ¥è¿”å›æ–‡ä»¶çš„å®Œæ•´é“¾æ¥é…ç½®
function generateDiskLink(filename) {
  var fileLink = fileLinks[filename];
  if (!fileLink) {
    console.log("æœªæ‰¾åˆ°æ–‡ä»¶é“¾æ¥:", filename);
    console.log("å¯ç”¨é“¾æ¥:", Object.keys(fileLinks));
    return null;
  }
  
  return {
    url: fileLink.url || "",
    code: fileLink.code || "",
    source: fileLink.source || "æœªçŸ¥ç½‘ç›˜",
    requireCode: fileLink.requireCode || false
  };
}

// åˆ›å»ºå•å…ƒæ ¼
function createCell(value, text) {
  var cell = document.createElement("td");
  cell.setAttribute("class", "detailsColumn");
  cell.dataset.value = value;
  cell.innerText = text;
  return cell;
}

// æ‹–æ‹½å¼€å§‹äº‹ä»¶
function onDragStart(e) {
  var el = e.srcElement;
  var name = el.innerText.replace(":", "");
  var downloadUrl = el.getAttribute('data-download-url') || el.href;
  var download_url_data = "application/octet-stream:" + name + ":" + downloadUrl;
  e.dataTransfer.setData("DownloadURL", download_url_data);
  e.dataTransfer.effectAllowed = "copy";
}

// å¤åˆ¶æ–‡æœ¬åˆ°å‰ªè´´æ¿
function copyToClipboard(text) {
  navigator.clipboard.writeText(text).then(function() {
    console.log('å¤åˆ¶æˆåŠŸ: ' + text);
  }, function(err) {
    console.error('å¤åˆ¶å¤±è´¥: ', err);
    // é™çº§æ–¹æ¡ˆ
    var textArea = document.createElement("textarea");
    textArea.value = text;
    document.body.appendChild(textArea);
    textArea.select();
    try {
      document.execCommand('copy');
    } catch (err) {
      console.error('é™çº§å¤åˆ¶å¤±è´¥: ', err);
    }
    document.body.removeChild(textArea);
  });
}

// æ‰“å¼€ç½‘ç›˜é“¾æ¥
function openDiskLink(linkInfo) {
  if (linkInfo && linkInfo.url) {
    window.open(linkInfo.url, '_blank');
    return true;
  }
  return false;
}

// æ˜¾ç¤ºç½‘ç›˜é“¾æ¥å¯¹è¯æ¡†
function showDiskLinkDialog(filename, fileSize, fileDesc, linkInfo) {
  var dialog = document.createElement('div');
  dialog.className = 'disk-link-dialog';
  
  var contentHtml = `
    <div class="disk-link-dialog-content">
      <h3>ç½‘ç›˜ä¸‹è½½</h3>
      <div class="file-info">
        <p><strong>æ–‡ä»¶å:</strong> ${filename}</p>
        <p><strong>å¤§å°:</strong> ${formatFileSize(fileSize)}</p>
        <p><strong>æè¿°:</strong> ${fileDesc || "æ— æè¿°ä¿¡æ¯"}</p>
        <p><strong>ç½‘ç›˜:</strong> <span class="disk-source">${linkInfo.source}</span></p>
      </div>
      <div class="link-section">
        <h4>ä¸‹è½½é“¾æ¥</h4>
        <div class="link-box">
          <input type="text" readonly value="${linkInfo.url}" id="link-input-${Date.now()}">
          <button class="btn-copy-link" data-link="${linkInfo.url}">å¤åˆ¶é“¾æ¥</button>
        </div>
  `;
  
  if (linkInfo.requireCode && linkInfo.code) {
    contentHtml += `
        <div class="code-section">
          <h4>æå–ç </h4>
          <div class="code-box">
            <input type="text" readonly value="${linkInfo.code}" id="code-input-${Date.now()}">
            <button class="btn-copy-code" data-code="${linkInfo.code}">å¤åˆ¶æå–ç </button>
          </div>
        </div>
    `;
  }
  
  contentHtml += `
      </div>
      <div class="instructions">
        <p><strong>ä½¿ç”¨è¯´æ˜:</strong></p>
        <ol>
          <li>ç‚¹å‡»ä¸‹æ–¹"æ‰“å¼€ç½‘ç›˜"æŒ‰é’®è·³è½¬åˆ°ç½‘ç›˜é¡µé¢</li>
          ${linkInfo.requireCode && linkInfo.code ? '<li>å¦‚æœéœ€è¦æå–ç ï¼Œå·²è‡ªåŠ¨å¤åˆ¶åˆ°å‰ªè´´æ¿</li>' : ''}
          <li>åœ¨ç½‘ç›˜é¡µé¢ä¸‹è½½æ–‡ä»¶</li>
        </ol>
      </div>
      <div class="action-buttons">
        <button class="btn-open-disk">æ‰“å¼€ç½‘ç›˜</button>
        <button class="btn-close-dialog">å…³é—­</button>
      </div>
    </div>
  `;
  
  dialog.innerHTML = contentHtml;
  
  dialog.style.cssText = `
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0,0,0,0.7);
    display: flex;
    justify-content: center;
    align-items: center;
    z-index: 1000;
  `;
  
  var content = dialog.querySelector('.disk-link-dialog-content');
  content.style.cssText = `
    background-color: white;
    padding: 25px;
    border-radius: 10px;
    max-width: 600px;
    width: 90%;
    max-height: 90vh;
    overflow-y: auto;
    box-shadow: 0 5px 30px rgba(0,0,0,0.3);
  `;
  
  // æ·»åŠ æŒ‰é’®äº‹ä»¶
  dialog.querySelector('.btn-open-disk').addEventListener('click', function() {
    openDiskLink(linkInfo);

    
    document.body.removeChild(dialog);
  });
  
  dialog.querySelector('.btn-copy-link').addEventListener('click', function() {
    var link = this.getAttribute('data-link');
    copyToClipboard(link);
    this.textContent = 'å·²å¤åˆ¶';
    this.style.backgroundColor = '#28a745';
    setTimeout(() => {
      this.textContent = 'å¤åˆ¶é“¾æ¥';
      this.style.backgroundColor = '';
    }, 2000);
  });
  
  if (linkInfo.requireCode && linkInfo.code) {
    dialog.querySelector('.btn-copy-code').addEventListener('click', function() {
      var code = this.getAttribute('data-code');
      copyToClipboard(code);
      this.textContent = 'å·²å¤åˆ¶';
      this.style.backgroundColor = '#28a745';
      setTimeout(() => {
        this.textContent = 'å¤åˆ¶æå–ç ';
        this.style.backgroundColor = '';
      }, 2000);
    });
  }
  
  dialog.querySelector('.btn-close-dialog').addEventListener('click', function() {
    document.body.removeChild(dialog);
  });
document.body.appendChild(dialog);
}

// æ·»åŠ æ–‡ä»¶è¡Œåˆ°è¡¨æ ¼
function addRow(name, isdir, size, size_string, date_modified_string, description, path) {
  if (name === "." || name === "..") return;
  
  var tbody = document.getElementById("tbody");
  var row = document.createElement("tr");
  var file_cell = document.createElement("td");
  var link = document.createElement("a");
  
  link.className = isdir ? "icon dir" : "icon file";
  
  if (isdir) {
    name = name + "/";
    
    // ç›®å½•ç‚¹å‡»äº‹ä»¶ï¼šå¯¼èˆªåˆ°å­ç›®å½•
    link.addEventListener("click", function(e) {
      e.preventDefault();
      var newPath = currentPath.endsWith("/") ? 
                   currentPath + name.slice(0, -1) + "/" : 
                   currentPath + "/" + name.slice(0, -1) + "/";
      navigateTo(newPath);
    });
    
    size = 0;
    size_string = "";
  } else {
    // æ–‡ä»¶ï¼šæ·»åŠ æ‹–æ‹½åŠŸèƒ½
    link.draggable = "true";
    link.addEventListener("dragstart", onDragStart, false);
    
    // æ–‡ä»¶ç‚¹å‡»äº‹ä»¶ï¼šæ˜¾ç¤ºç½‘ç›˜é“¾æ¥å¯¹è¯æ¡†
    link.href = "#";
	link.addEventListener("click", function(e) {
	  e.preventDefault();
	  
	  var linkInfo = generateDiskLink(name);
	  console.log('ç‚¹å‡»äº‹ä»¶è§¦å‘', name);
	  
	  if (!linkInfo || !linkInfo.url) {
		alert("æœªæ‰¾åˆ°æ­¤æ–‡ä»¶çš„ä¸‹è½½é“¾æ¥ï¼Œè¯·è”ç³»ç®¡ç†å‘˜æ·»åŠ ã€‚æ–‡ä»¶å: " + name);
		return;
	  }
	  
	  showDiskLinkDialog(name, size, description, linkInfo);
	  console.log('ç‚¹å‡»äº‹ä»¶è§¦å‘', name);
	  
	  // è®°å½•ä¸‹è½½ç»Ÿè®¡
	  recordDownloadStat(name, path, linkInfo.source);
	});
  }
  
  link.innerText = name;
  file_cell.dataset.value = name;
  
  // æ·»åŠ æè¿°ä¿¡æ¯ï¼ˆå¦‚æœæœ‰ï¼‰
  var fullDescription = description || "";
  if (fullDescription) {
    link.title = fullDescription;
  }
  
  file_cell.appendChild(link);
  
  row.appendChild(file_cell);
  row.appendChild(createCell(size, size_string || formatFileSize(size)));
  row.appendChild(createCell(date_modified_string, date_modified_string));
  
  tbody.appendChild(row);
}

// è®°å½•ä¸‹è½½ç»Ÿè®¡
function recordDownloadStat(filename, path, source) {
  console.log("ç”¨æˆ·è®¿é—®ä¸‹è½½: ", filename, "è·¯å¾„:", path, "ç½‘ç›˜:", source, "æ—¶é—´:", new Date().toLocaleString());
  
  // è¿™é‡Œå¯ä»¥å‘é€ç»Ÿè®¡åˆ°æœåŠ¡å™¨
  // æˆ–è€…ä½¿ç”¨localStorageè®°å½•
  try {
    var downloadHistory = JSON.parse(localStorage.getItem('downloadHistory') || '[]');
    downloadHistory.unshift({
      filename: filename,
      path: path,
      source: source,
      time: new Date().toISOString()
    });
    
    // åªä¿ç•™æœ€è¿‘çš„100æ¡è®°å½•
    if (downloadHistory.length > 100) {
      downloadHistory = downloadHistory.slice(0, 100);
    }
    
    localStorage.setItem('downloadHistory', JSON.stringify(downloadHistory));
  } catch (e) {
    console.error("è®°å½•ä¸‹è½½å†å²å¤±è´¥:", e);
  }
}

// å¯¼èˆªåˆ°æŒ‡å®šè·¯å¾„
function navigateTo(path) {
  // ä¿å­˜å½“å‰è·¯å¾„åˆ°å†å²è®°å½•
  if (currentPath !== path) {
    historyStack.push(currentPath);
  }
  
  currentPath = path;
  renderDirectory();
  
  // æ›´æ–°æµè§ˆå™¨URLï¼ˆä¸åˆ·æ–°é¡µé¢ï¼‰
  history.pushState({path: path}, "", "#" + encodeURIComponent(path));
}

// è¿”å›ä¸Šä¸€çº§ç›®å½•
function navigateUp() {
  if (historyStack.length > 0) {
    var prevPath = historyStack.pop();
    currentPath = prevPath;
    renderDirectory();
    
    // æ›´æ–°æµè§ˆå™¨URL
    history.pushState({path: prevPath}, "", "#" + encodeURIComponent(prevPath));
  } else if (currentPath !== "/") {
    // å¦‚æœæ²¡æœ‰å†å²è®°å½•ä½†ä¸åœ¨æ ¹ç›®å½•ï¼Œè¿”å›æ ¹ç›®å½•
    var parts = currentPath.split("/").filter(part => part.length > 0);
    if (parts.length > 0) {
      parts.pop();
      var parentPath = parts.length > 0 ? "/" + parts.join("/") + "/" : "/";
      currentPath = parentPath;
      renderDirectory();
      history.pushState({path: parentPath}, "", "#" + encodeURIComponent(parentPath));
    }
  }
}

// æ¸²æŸ“å½“å‰ç›®å½•
function renderDirectory() {
  // æ¸…ç©ºè¡¨æ ¼
  var tbody = document.getElementById("tbody");
  tbody.innerHTML = "";
  
  // æ›´æ–°æ ‡é¢˜
  var header = document.getElementById("header");
  header.innerText = "Vizyn | WinBetaä¸‹è½½ - " + (currentPath === "/" ? "æ ¹ç›®å½•" : currentPath);
  document.getElementById("title").innerText = header.innerText;
  
  // æ›´æ–°çˆ¶ç›®å½•é“¾æ¥
  var parentDirBox = document.getElementById("parentDirLinkBox");
  if (currentPath === "/") {
    parentDirBox.style.display = "none";
  } else {
    parentDirBox.style.display = "block";
    var parentDirLink = document.getElementById("parentDirLink");
    parentDirLink.href = "#";
    parentDirLink.onclick = function(e) {
      e.preventDefault();
      navigateUp();
    };
  }
  
  // è·å–å½“å‰ç›®å½•çš„æ–‡ä»¶åˆ—è¡¨
  var files = directoryData[currentPath];
  
  if (files && files.length > 0) {
    // æ·»åŠ çˆ¶ç›®å½•é¡¹ï¼ˆå¦‚æœä¸æ˜¯æ ¹ç›®å½•ï¼‰
    if (currentPath !== "/") {
      addRow("..", 1, 0, "", "");
    }
    
    // æ·»åŠ ç›®å½•å’Œæ–‡ä»¶
    files.forEach(function(item) {
      addRow(
        item.name,
        item.type === "dir" ? 1 : 0,
        item.size,
        item.size_string || formatFileSize(item.size),
        item.modified_str,
        item.description,
        currentPath === "/" ? "/" + item.name : currentPath + item.name
      );
    });
  } else {
    // å¦‚æœæ²¡æœ‰æ•°æ®ï¼Œæ˜¾ç¤ºç©ºç›®å½•æ¶ˆæ¯
    var row = document.createElement("tr");
    var cell = document.createElement("td");
    cell.colSpan = 3;
    cell.style.textAlign = "center";
    cell.style.padding = "20px";
    cell.innerText = "æ­¤ç›®å½•ä¸ºç©º";
    row.appendChild(cell);
    tbody.appendChild(row);
  }
}

// è¡¨æ ¼æ’åºå‡½æ•°
function sortTable(column) {
  var theader = document.getElementById("theader");
  var oldOrder = theader.cells[column].dataset.order || '1';
  oldOrder = parseInt(oldOrder, 10)
  var newOrder = 0 - oldOrder;
  theader.cells[column].dataset.order = newOrder;

  var tbody = document.getElementById("tbody");
  var rows = tbody.rows;
  var list = [], i;
  for (i = 0; i < rows.length; i++) {
    list.push(rows[i]);
  }

  list.sort(function(row1, row2) {
    var a = row1.cells[column].dataset.value;
    var b = row2.cells[column].dataset.value;
    
    // è·³è¿‡çˆ¶ç›®å½•é¡¹
    if (a === ".." || b === "..") {
      return a === ".." ? -1 : 1;
    }
    
    if (column === 1) {
      a = parseInt(a, 10);
      b = parseInt(b, 10);
      return a > b ? newOrder : a < b ? oldOrder : 0;
    }

    // ç¬¬0åˆ—æ˜¯æ–‡æœ¬
    if (a > b)
      return newOrder;
    if (a < b)
      return oldOrder;
    return 0;
  });

  for (i = 0; i < list.length; i++) {
    tbody.appendChild(list[i]);
  }
}

// ä¸ºåˆ—æ ‡é¢˜æ·»åŠ äº‹ä»¶å¤„ç†å™¨
function addHandlers(element, column) {
  element.onclick = (e) => sortTable(column);
  element.onkeydown = (e) => {
    if (e.key == 'Enter' || e.key == ' ') {
      sortTable(column);
      e.preventDefault();
    }
  };
}

// åˆå§‹åŒ–é“¾æ¥ç®¡ç†
function initLinkManager() {
  // ä»localStorageåŠ è½½ä¿å­˜çš„é“¾æ¥ï¼ˆå¯é€‰ï¼Œå¦‚æœè¿˜éœ€è¦è¿™ä¸ªåŠŸèƒ½ï¼‰
  var savedLinks = localStorage.getItem('fileLinks');
  if (savedLinks) {
    try {
      var parsedLinks = JSON.parse(savedLinks);
      Object.assign(fileLinks, parsedLinks);
    } catch (e) {
      console.error('åŠ è½½ä¿å­˜çš„é“¾æ¥å¤±è´¥:', e);
    }
  }
}

// é¡µé¢åŠ è½½å®Œæˆ
function onLoad() {
  // åˆå§‹åŒ–ç›®å½•æ•°æ®
  initDirectoryData();
  
  // åˆå§‹åŒ–é“¾æ¥ç®¡ç†ï¼ˆå¯é€‰ï¼‰
  initLinkManager();
  
  // æ£€æŸ¥URLä¸­çš„è·¯å¾„å‚æ•°
  var hash = window.location.hash;
  if (hash && hash.length > 1) {
    var pathFromURL = decodeURIComponent(hash.substring(1));
    if (directoryData[pathFromURL] || pathFromURL === "/") {
      currentPath = pathFromURL;
    }
  }
  
  // æ¸²æŸ“åˆå§‹ç›®å½•
  renderDirectory();
  
  // æ·»åŠ æ’åºäº‹ä»¶å¤„ç†å™¨
  addHandlers(document.getElementById('nameColumnHeader'), 0);
  addHandlers(document.getElementById('sizeColumnHeader'), 1);
  addHandlers(document.getElementById('dateColumnHeader'), 2);
}

// ç›‘å¬æµè§ˆå™¨å‰è¿›/åé€€
window.addEventListener('popstate', function(event) {
  if (event.state && event.state.path) {
    currentPath = event.state.path;
    renderDirectory();
  }
});

// ç›‘å¬DOMåŠ è½½å®Œæˆ
window.addEventListener('DOMContentLoaded', onLoad);

// è¿”å›ä¸»é¡µå‡½æ•°
function goToHome() {
  var homeUrl = "https://millseasy-github-io.pages.dev/vizyn/";
  window.location.href = homeUrl;
}
</script>

<style>
  /* æ ·å¼ä¿æŒä¸å˜ */
  body {
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
    margin: 20px;
    background-color: #f0f2f5;
    color: #333;
    line-height: 1.6;
  }
  
  h1 {
    border-bottom: 2px solid #0078d4;
    margin-bottom: 15px;
    padding-bottom: 10px;
    white-space: nowrap;
    font-size: 1.8em;
    color: #005a9e;
    font-weight: 600;
  }

  table {
    border-collapse: collapse;
    width: 100%;
    background-color: white;
    box-shadow: 0 2px 10px rgba(0,0,0,0.1);
    border-radius: 6px;
    overflow: hidden;
  }
  
  th {
    cursor: pointer;
    background-color: #f3f6f9;
    padding: 14px 16px;
    text-align: left;
    font-weight: 600;
    border-bottom: 2px solid #dee2e6;
    color: #495057;
    transition: background-color 0.2s;
  }
  
  th:hover {
    background-color: #e9ecef;
  }
  
  td {
    padding: 12px 16px;
    border-bottom: 1px solid #eaeaea;
  }
  
  tr:hover {
    background-color: #f8f9fa;
  }

  td.detailsColumn {
    padding-inline-start: 2em;
    text-align: end;
    white-space: nowrap;
    color: #666;
  }

  a.icon {
    padding-inline-start: 1.8em;
    text-decoration: none;
    user-select: auto;
    color: #0078d4;
    display: inline-block;
    padding: 4px 0 4px 28px;
    background-repeat: no-repeat;
    background-position: left center;
    min-height: 24px;
    line-height: 24px;
    transition: color 0.2s;
    font-weight: 500;
    cursor: pointer;
  }

  a.icon:hover {
    text-decoration: underline;
    color: #005a9e;
  }

  a.file {
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAIAAACQkWg2AAAABnRSTlMAAAAAAABupgeRAAABEElEQVR42nRRx3HDMBC846AHZ7sP54BmWAyrsP588qnwlhqw/k4v5ZwWxM1hzmGRgV1cYqrRarXoH2w2m6qqiqKIR6cPtzc3xMSML2Te7XZZlnW7Pe/91/dX47WRBHuA9oyGmRgnzGDjab1ePzw8bLfb6WRalmW4ip9FDVpYSWZgOp12Oh3nXJ7nxoJSGEciteP9y+fH52q1euv38WosqA6T2gGOT44vry7BEQtJkMAMMpa6JagAMcUfWYa4hkkzAc7fFlSjwqCoOUYAF5RjHZPVCFBOtSBGfgUDji3c3jpibeEMQhIMh8NwshqyRsBJgvF4jMs/YlVR5KhgNpuBLzk0OcUiR3CMhcPaOzsZiAAA/AjmaB3WZIkAAAAASUVORK5CYII=");
  }

  a.dir {
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAABt0lEQVR42oxStZoWQRCs2cXdHTLcHZ6EjAwnQWIkJyQlRt4Cd3d3d1n5d7q7ju1zv/q+mh6taQsk8fn29kPDRo87SDMQcNAUJgIQkBjdAoRKdXjm2mOH0AqS+PlkP8sfp0h93iu/PDji9s2FzSSJVg5ykZqWgfGRr9rAAAQiDFoB1OfyESZEB7iAI0lHwLREQBcQQKqo8p+gNUCguwCNAAUQAcFOr0NNGjT+BbUC2YsHZpWLhC6/m0chqIoM1LKbQIIBwlTQE1xAo9QDGDPYf6rkTpPc92gCUYVJAZjhyZltJ95f3zuvLYRGWWCUNkDL2333McBh4kaLlxg+aTmyL7c2xTjkN4Bt7oE3DBP/3SRz65R/bkmBRPGzcRNHYuzMjaj+fdnaFoJUEdTSXfaHbe7XNnMPyqryPcmfY+zURaAB7SHk9cXSH4fQ5rojgCAVIuqCNWgRhLYLhJB4k3iZfIPtnQiCpjAzeBIRXMA6emAqoEbQSoDdGxFUrxS1AYcpaNbBgyQBGJEOnYOeENKR/iAd1npusI4C75/c3539+nbUjOgZV5CkAU27df40lH+agUdIuA/EAgDmZnwZlhDc0wAAAABJRU5ErkJggg==");
  }

  a.up {
    background-image: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAACM0lEQVR42myTA+w1RxRHz+zftmrbdtq04qRGrCmvbDWp9tq3a7tPcub8mj9XZ3eHOGQdJAHw77/LbZuvnWy+c/CIAd+91CMf3bo+bgcBiBAGIZKXb19/zodsAkFT+3px+ssYfyHTQW5tr05dCOf3xN49KaVX9+2zy1dX4XMk+5JflN5MBPL30oVsvnvEyp+18Nt3ZAErQMSFOfelCFvw0HcUloDayljZkX+MmamTAMTe+d+ltZ+1wEaRAX/MAnkJdcujzZyErIiVSzCEvOiq4O83AG7LAkwsfIgAnbncag82jfPPdd9RQyhPkpNJvKJUQBKlYFmQA315n4YPNjwMAZYy0TgAweedLmLzTJSTLIxkWDaVCVfAbbiKjytgmm+EGpMBYW0Wwwbb7tL8anox/UxekaOW544HO0ANAshxuORT/RG5YSrjlwZ3lM955tlQqbtVMlWIhjwzkAVFB8Q9EAAA3AFJ+DR3DO/Pnd3NPi7H117rAzWjpEs8vfIqsGZpaweOfEAAFJKuM0v6kf2iC5pZ9+fmLSZfWBVaKfLLNOXj6lYY0V2lfyVCIsVzmcRV9Y0fx02eTaEwhl2PDrXcjFdYRAohQmS8QEFLCLKGYA0AeEakhCCFDXqxsE0AQACgAQp5w96o0lAXuNASeDKWIpADiHwigfBINpWKtAXJvCEKWgSJNbRvxf4SmrnKDpvZavePu1K/zu/due1X/6Nj90MBd/J2Cic7WjBp/jUdIuA8AUtd65M+PzXIAAAAASUVORK5CYII=");
  }

  #parentDirLinkBox {
    margin-bottom: 15px;
    padding-bottom: 10px;
  }
  
  #parentDirLink {
    display: inline-block;
    padding: 10px 18px 10px 40px;
    background-color: #e6f2ff;
    border-radius: 5px;
    color: #005a9e;
    text-decoration: none;
    border: 1px solid #c7e0f4;
    font-weight: 500;
    transition: background-color 0.2s;
  }
  
  #parentDirLink:hover {
    background-color: #d0e7ff;
    text-decoration: none;
  }
  
  /* ç½‘ç›˜é“¾æ¥å¯¹è¯æ¡†æ ·å¼ */
  .disk-link-dialog-content h3 {
    margin-top: 0;
    color: #005a9e;
    display: flex;
    align-items: center;
  }
  
  .icon-disk::before {
    content: "ğŸ’¾";
    margin-right: 10px;
    font-size: 1.2em;
  }
  
  .file-info {
    background-color: #f8f9fa;
    padding: 15px;
    border-radius: 5px;
    margin: 15px 0;
  }
  
  .file-info p {
    margin: 8px 0;
  }
  
  .disk-source {
    background-color: #0078d4;
    color: white;
    padding: 3px 8px;
    border-radius: 3px;
    font-size: 0.9em;
  }
  
  .link-section, .code-section {
    margin: 20px 0;
  }
  
  .link-section h4, .code-section h4 {
    margin-bottom: 10px;
    color: #495057;
  }
  
  .link-box, .code-box {
    display: flex;
    gap: 10px;
  }
  
  .link-box input, .code-box input {
    flex: 1;
    padding: 10px;
    border: 1px solid #ced4da;
    border-radius: 4px;
    font-family: monospace;
    background-color: #f8f9fa;
  }
  
  .btn-copy-link, .btn-copy-code {
    padding: 10px 15px;
    background-color: #6c757d;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    white-space: nowrap;
    transition: background-color 0.2s;
  }
  
  .btn-copy-link:hover, .btn-copy-code:hover {
    background-color: #5a6268;
  }
  
  .instructions {
    background-color: #fff3cd;
    border-left: 4px solid #ffc107;
    padding: 15px;
    border-radius: 4px;
    margin: 20px 0;
  }
  
  .instructions ol {
    margin: 10px 0 0 0;
    padding-left: 20px;
  }
  
  .instructions li {
    margin-bottom: 5px;
  }
  
  .action-buttons {
    display: flex;
    gap: 10px;
    margin-top: 20px;
  }
  
  .btn-open-disk {
    flex: 1;
    padding: 12px;
    background-color: #28a745;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    font-weight: 500;
    font-size: 1.1em;
    transition: background-color 0.2s;
  }
  
  .btn-open-disk:hover {
    background-color: #218838;
  }
  
  .btn-close-dialog {
    padding: 12px 20px;
    background-color: #6c757d;
    color: white;
    border: none;
    border-radius: 4px;
    cursor: pointer;
    transition: background-color 0.2s;
  }
  
  .btn-close-dialog:hover {
    background-color: #5a6268;
  }
  
  .link-box input, .code-box input {
	  flex: 1;
	  padding: 10px;
	  border: 1px solid #ced4da;
	  border-radius: 4px;
	  font-family: monospace;
	  background-color: #f8f9fa;
	  color: #333 !important;
	  font-size: 14px;
	}

	.disk-link-dialog-content {
	  background-color: white;
	  padding: 25px;
	  border-radius: 10px;
	  max-width: 600px;
	  width: 90%;
	  max-height: 90vh;
	  overflow-y: auto;
	  box-shadow: 0 5px 30px rgba(0,0,0,0.3);
	  color: #333 !important;
	}

	.file-info {
	  background-color: #f8f9fa;
	  padding: 15px;
	  border-radius: 5px;
	  margin: 15px 0;
	  color: #333 !important;
	}

	.file-info p {
	  margin: 8px 0;
	  color: #333 !important;
	}

	.file-info strong {
	  color: #005a9e !important;
	}

	.disk-link-dialog-content h3 {
	  margin-top: 0;
	  color: #005a9e !important;
	  display: flex;
	  align-items: center;
	}

	.instructions {
	  background-color: #fff3cd;
	  border-left: 4px solid #ffc107;
	  padding: 15px;
	  border-radius: 4px;
	  margin: 20px 0;
	  color: #333 !important;
	}

	.instructions p, .instructions li {
	  color: #333 !important;
	}
	
	  #homeButton {
		position: fixed;
		top: 20px;
		right: 20px;
		padding: 10px 20px;
		background-color: #0078d4;
		color: white;
		text-decoration: none;
		border-radius: 5px;
		border: none;
		cursor: pointer;
		font-weight: 500;
		z-index: 999;
		box-shadow: 0 2px 10px rgba(0,0,0,0.2);
		transition: all 0.3s ease;
		font-size: 14px;
		display: flex;
		align-items: center;
		justify-content: center;
	  }

	  #homeButton:hover {
		background-color: #005a9e;
	  }

	  #homeButton:active {
		transform: translateY(0);
	  }

  @media (max-width: 768px) {
    body {
      margin: 10px;
    }
    
    h1 {
      font-size: 1.4em;
    }
    
    th, td {
      padding: 10px 12px;
    }
    
    .detailsColumn {
      font-size: 0.9em;
    }
    
    .link-box, .code-box {
      flex-direction: column;
    }
  }
</style>

<title id="title">Vizyn | WinBetaä¸‹è½½</title>
</head>

<body>

<h1 id="header">Vizyn | WinBetaä¸‹è½½</h1>

<button id="homeButton" onclick="goToHome()" title="è¿”å›ä¸»é¡µ">è¿”å›ä¸»é¡µ</button>

<div id="parentDirLinkBox" style="display:none">
  <a id="parentDirLink" class="icon up">
    <span id="parentDirText">[è¿”å›ä¸Šä¸€çº§]</span>
  </a>
</div>

<table>
  <thead>
    <tr class="header" id="theader">
      <th id="nameColumnHeader" tabindex=0 role="button">åç§°</th>
      <th id="sizeColumnHeader" class="detailsColumn" tabindex=0 role="button">
        å¤§å°
      </th>
      <th id="dateColumnHeader" class="detailsColumn" tabindex=0 role="button">
        ä¿®æ”¹æ—¥æœŸ
      </th>
    </tr>
  </thead>
  <tbody id="tbody">
  </tbody>
</table>

<div style="margin-top: 30px; padding: 15px; background-color: #f8f9fa; border-radius: 5px; font-size: 0.9em; color: #666; border-left: 4px solid #0078d4;">
  <strong>ä½¿ç”¨è¯´æ˜ï¼š</strong><br>
  1. ç‚¹å‡»ç›®å½•è¿›å…¥å­ç›®å½•<br>
  2. ç‚¹å‡»æ–‡ä»¶åç§°å¼¹å‡ºä¸‹è½½å¯¹è¯æ¡†<br>
  3. åœ¨å¯¹è¯æ¡†ä¸­ç‚¹å‡»"æ‰“å¼€ç½‘ç›˜"è·³è½¬è‡³ç¬¬ä¸‰æ–¹ç½‘ç›˜<br>
  4. æ¯ä¸ªæ–‡ä»¶éƒ½æœ‰ç‹¬ç«‹çš„ç½‘ç›˜é“¾æ¥å’Œé…ç½®<br>
  <strong>è­¦å‘Šï¼š</strong><br>
  å®‰è£…æµ‹è¯•ç‰ˆå­˜åœ¨é£é™©ï¼Œæœ¬ç«™æä¾›ç³»ç»Ÿé•œåƒæ˜¯ä¸ºå°é²œã€‚è¯·å‹¿å°†ç³»ç»Ÿå®‰è£…åˆ°å®ä½“æœºä¸Šï¼Œè‹¥æ‚¨å°è¯•è¿™æ ·åšå¯¼è‡´çš„æ•°æ®æŸå¤±ï¼Œæœ¬ç«™ä¸æ‰¿æ‹…ä»»ä½•åæœï¼<br>
</div>
<p>æœ¬é¡µé¢ç”± æ –æ¸ŠKaelen æä¾› | Chromium å†…ç½®çš„æ–‡ä»¶ç®¡ç†å™¨</p>
<script>
// å…¼å®¹æ€§å¤„ç†
if (!window.history.pushState) {
  console.warn("æµè§ˆå™¨ä¸æ”¯æŒHTML5 History APIï¼Œå¯¼èˆªåŠŸèƒ½å—é™");
}

// åˆå§‹åŒ–æ—¶æ£€æŸ¥é“¾æ¥é…ç½®
window.addEventListener('DOMContentLoaded', function() {
  // æ£€æŸ¥æ˜¯å¦æœ‰æœªé…ç½®é“¾æ¥çš„æ–‡ä»¶
  var unconfiguredFiles = [];
  for (var path in fileSystemData) {
    if (path !== "/") {
      var files = fileSystemData[path];
      files.forEach(function(file) {
        if (file.type === "file" && !fileLinks[file.name]) {
          unconfiguredFiles.push(file.name);
        }
      });
    }
  }
  
  if (unconfiguredFiles.length > 0) {
    console.log("æœªé…ç½®é“¾æ¥çš„æ–‡ä»¶:", unconfiguredFiles);
  }
});
</script>

</body>
</html>